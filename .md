# Ler dados extraidos do Monde
dados <- read_xlsx("C:/Users/Usuario.WELLNB-24/Desktop/Processo TravelBack Weex/2025/Dez/Relatório Monde - Retorno 23-12 a 02-02.xlsx")
colnames(dados)
 
dados <- dados %>%
  # Remover onde Tipo Pessoa é igual a "J"
  filter(`Tipo Pessoa` != "J") %>%
  # Remover onde Setor é diferente de "Lazer"
  filter(`Setor` == "Lazer") %>%
  # Remover onde Produto é igual a "Taxa de Serviço"
  filter(`Produto` != "Taxa de Serviço") %>%
  # Remover onde Receitas é menor ou igual a zero
  filter(Receitas > 0) %>%
  # Remover onde o E-mail contém "@welcome"
  filter(!grepl("@welcome", `E-mail`))
 
dados <- dados %>%
  mutate("% Pontos" = Receitas/100*3.2)
 
# Função personalizada para o critério de arredondamento descrito
arredondar_personalizado <- function(x) {
  # Separar a parte inteira e decimal
  parte_inteira <- floor(x)
  parte_decimal <- x - parte_inteira
  # Critério de arredondamento
  if (parte_decimal < 0.5) {
    return(parte_inteira)  # Menor que X,5 arredonda para baixo
  } else if (parte_decimal > 0.5) {
    return(ceiling(x))  # Maior que X,5 arredonda para cima
  } else {
    # Se for exatamente X,5
    if (parte_inteira %% 2 == 0) {
      return(parte_inteira + 1)  # Arredonda para cima se o próximo número for par
    } else {
      return(parte_inteira)  # Arredonda para baixo se o próximo número for ímpar
    }
  }
}
 
# Aplicar o critério de arredondamento na nova coluna
dados <- dados %>%
  mutate(`Pontos Arredondados` = sapply(`% Pontos`, arredondar_personalizado)) %>%
  mutate(`E-mail` = tolower(`E-mail`))